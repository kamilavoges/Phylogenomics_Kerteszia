################################### aligning with translatorX ################################################

cd work directory/57_at_least_30
nohup awk '(1==1){file="work directory/multifasta/b146_b56_bo8_c40_cdp_gu_itF_itM_ml8_ml11_res_u137_b160_b104_b140_b66_b85_b86_bo2_ml21_ml121_u1011_u75_u62_Pou1_V1_V3_c1_c11_c14_c25_c31_c33_c34_c36_G2_uNan_bNan_BO3_IG2_CJ7_CJ6_CJ4_CJ9_IG5_P1_P2_P3_P4_P5_S1_S2_S3_b7f_b1m_sb1_sc1_sc2_sc3_" $1 ".fna" ;   system("perl ../translatorx_vLocal.pl -g 1 -t F -i " file " -o " $1".trx ")}'  work directory/59_at_least_30/59atleast30speciesCV9.gene_name > nohup_trx.out &  

#will generate the files trx.nt_ali.fasta

###############################Single gene ML tree inference######################################## 

### I created a list file to be able to run the autoiqtree
ls *at7147.trx.nt_ali.fasta > list 

cd work directory/59_at_least_30
mv *nt_ali.fasta ali.fasta/
mkdir cleanali.fasta

cp -p work directory/59_at_least_30/*cleanali.fasta work directory/59_at_least_30/ali.fasta

nohup perl AutoIQTree.pl & #

#########################################################################TreeShrink###########################################################################

mkdir work directory/TreeShrink/

mkdir work directory/TreeShrink/Input_dir_59_at_least_30

nohup nice -10 perl makedirectories.pl &

nohup nice -10 perl copydirectories.pl & 

nohup nice -10 perl correctname.pl & 

nohup python /draft5/kamila/Fil40genomas_com_sanger_at_least35/TreeShrink/Input_dir_40_at_least_35/TreeShrink/run_treeshrink.py -i /draft5/kamila/Fil59genomas/59_at_least_30/TreeShrink/Input_dir_59_at_least_30 -t tree_file -a cleanali_file -o /draft5/kamila/Fil59genomas/59_at_least_30/TreeShrink/Input_dir_59_at_least_30 &


cd work directory/TreeShrink/TreeShrink
mv nohup.out nohup_TreeShrink.out


nohup perl change_align_names.pl & #320904

######################## ASTRAL (MSC)################################################## 
#Multispecies coalescent method for species tree inference

cat *at7147*/*output.nwk > list_treefile

nohup java -jar /home/tools/Astral/astral.5.7.3.jar -i  list_treefile.nwk &
 

########################IQ-TREE (ML)#####################################################################

ls *at7147*/*cleanali_file_shrunk0.05 > list_59_alin_shrunk0.05 

nohup perl Concat_MissingData.pl & 

I had to create a nexus file with partition information. I used Concat.info and edited it in notepad++ in order to create a nexus file 

nohup /home6/tools/iqtree-3.0.0-Linux-intel/bin/iqtree3 -s Concat.fas -spp Concat_59_30gen.nex -m MFP -B 1000 -nt AUTO > nohup_iqtree.out 2>&1 &




